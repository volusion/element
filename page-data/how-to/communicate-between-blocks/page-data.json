{"componentChunkName":"component---src-templates-docs-js","path":"/how-to/communicate-between-blocks","result":{"data":{"site":{"siteMetadata":{"title":"Element Documentation | Volusion","docsLocation":"https://github.com/volusion/element"}},"mdx":{"fields":{"id":"39da7718-2b20-5b0e-93d4-656400fbf1fb","title":"Communicate Between Blocks","slug":"/how-to/communicate-between-blocks"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Communicate Between Blocks\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Sometimes, it may be necessary for one block to send information to another block on the same page. In Element, blocks can communicate with each other via a pub-sub mechanism. This guide will explain how to send information between two (or more) blocks.\"), mdx(\"p\", null, \"All blocks have access to an instance of PubSubJS as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"this.props.pubSub\"), \".\"), mdx(\"p\", null, \"For more details on PubSubJS, see the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.npmjs.com/package/pubsub-js\"\n  }), \"PubSubJS npm reference\"), \".\"), mdx(\"h2\", null, \"1. Identify the Blocks That Need to Communicate with Each Other\"), mdx(\"p\", null, \"The first step of setting up block communication is figuring out which block will send messages (the sender), and which blocks will receive those messages (the receivers). In Element, some pre-made blocks already send messages to each other, and you can listen for those events in your blocks. See the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/element/references/cart-events\"\n  }), \"Cart Events Reference\"), \" for more info.\"), mdx(\"p\", null, \"For this guide, you will be setting up \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"your own blocks\"), \" as senders and receivers of messages.\"), mdx(\"h2\", null, \"2. Add a Publish Action to Your Sender Block\"), mdx(\"p\", null, \"Once you have identified which block will send messages to other blocks, you need to set up a publish action in that block's code.\"), mdx(\"h3\", null, \"Add a Function to Send Your Message\"), mdx(\"p\", null, \"For this guide, we'll use the example of sending a message between blocks when a user changed an option for a product they were viewing.\"), mdx(\"p\", null, \"Send your message using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"utils.pubSub.publish()\"), \" in your block. This function takes two arguments:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A topic name (string), which can be any value you like. Your other block(s) will listen for this topic.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A data value (any type). This is the piece of data you will send to your other block(s).\")), mdx(\"p\", null, \"Example:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// in your block component body, add a function. Here we're doing it as an instance property because this component is a class.\\nhandleOptionChange = event => {\\n    const newOptionValue = event.target.value;\\n    this.props.pubSub.publish('myEvents_PRODUCT_OPTION_CHANGED', newOptionValue);\\n};\\n\")), mdx(\"p\", null, \"Note: if your component is a stateless functional component rather than an ES6 class, you would define your function as a const rather than an instance property.\"), mdx(\"h3\", null, \"Prefix Your Topic Names!\"), mdx(\"p\", null, \"It's always a good idea to add a unique prefix to topic names that you create, to ensure that you don't collide with any other existing topic names. This way, your events will all live in their own \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"namespace\"), \". In this example, our topic is named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"myEvents_PRODUCT_OPTION_CHANGED\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"myEvents_\"), \" is the prefix we have chosen. You should choose something descriptive and unique.\"), mdx(\"h3\", null, \"Call Your Function at the Appropriate Time\"), mdx(\"p\", null, \"You can call your function from anywhere else in your block code. For this example, you would call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"this.handleOptionChange\"), \" from the onChange event for a select element, like so:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"    <select onChange={this.handleOptionChange}>\\n\")), mdx(\"h2\", null, \"3. Listen for Published Messages in Your Receiver Block(s)\"), mdx(\"p\", null, \"At this point, you have a block that's sending messages, but you need to set up one or more blocks to listen for those messages.\"), mdx(\"h3\", null, \"Add a Subscription in Your Block's componentDidMount Function\"), mdx(\"p\", null, \"Locate the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"componentDidMount\"), \" function of one of your receiver blocks. If this function doesn't exist yet, add it to your component. You may need to refactor the block to use class syntax. Then add a subscription:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"componentDidMount() {\\n    this.props.pubSub.subscribe(\\n        'myEvents_PRODUCT_OPTION_CHANGED', // must match the topic name EXACTLY\\n        this.onOptionChanged\\n    );\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"utils.pubSub.subscribe()\"), \" takes two arguments:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A topic name (string), which can be any value that a sender block is publishing.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A handler function. The message will be passed to the handler function.\")), mdx(\"h3\", null, \"Implement Your Handler Function for the Subscription\"), mdx(\"p\", null, \"Your handler function is the code that actually does something with the data received from another block. Add it to your block component as an instance property.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// inside the body of your component\\nonOptionChanged = (msg, newOptionValue) => {\\n    // do something with newOptionValue. In this example we will set it to state.\\n    this.setState({ productOption: newOptionValue });\\n};\\n\")), mdx(\"p\", null, \"Repeat this process for more receiver blocks, if necessary.\"), mdx(\"h2\", null, \"Appendix: Listening for Existing Messages\"), mdx(\"p\", null, \"To set up your blocks to listen for existing messages, see the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/element/references/cart-events\"\n  }), \"Cart Events Reference\"), \".\"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#1-identify-the-blocks-that-need-to-communicate-with-each-other","title":"1. Identify the Blocks That Need to Communicate with Each Other"},{"url":"#2-add-a-publish-action-to-your-sender-block","title":"2. Add a Publish Action to Your Sender Block","items":[{"url":"#add-a-function-to-send-your-message","title":"Add a Function to Send Your Message"},{"url":"#prefix-your-topic-names","title":"Prefix Your Topic Names!"},{"url":"#call-your-function-at-the-appropriate-time","title":"Call Your Function at the Appropriate Time"}]},{"url":"#3-listen-for-published-messages-in-your-receiver-blocks","title":"3. Listen for Published Messages in Your Receiver Block(s)","items":[{"url":"#add-a-subscription-in-your-blocks-componentdidmount-function","title":"Add a Subscription in Your Block's componentDidMount Function"},{"url":"#implement-your-handler-function-for-the-subscription","title":"Implement Your Handler Function for the Subscription"}]},{"url":"#appendix-listening-for-existing-messages","title":"Appendix: Listening for Existing Messages"}]},"parent":{"relativePath":"how-to/communicate-between-blocks.md"},"frontmatter":{"metaTitle":null,"metaDescription":null}},"allMdx":{"edges":[{"node":{"fields":{"slug":"/explanations","title":"Explanations"}}},{"node":{"fields":{"slug":"/how-to","title":"How-to Guides"}}},{"node":{"fields":{"slug":"/","title":"Element Platform documentation"}}},{"node":{"fields":{"slug":"/introduction","title":"What Is Element?"}}},{"node":{"fields":{"slug":"/tutorials","title":"Tutorials"}}},{"node":{"fields":{"slug":"/references","title":"Reference"}}},{"node":{"fields":{"slug":"/references/block-utils","title":"Block Utils"}}},{"node":{"fields":{"slug":"/references/cart-events","title":"Cart Events"}}},{"node":{"fields":{"slug":"/references/element-cli","title":"Element CLI Reference"}}},{"node":{"fields":{"slug":"/references/proptypes","title":"Proptypes"}}},{"node":{"fields":{"slug":"/references/styling-your-block-with-css","title":"Styling Your Block With CSS"}}},{"node":{"fields":{"slug":"/how-to/add-blocks-to-template","title":"Add Blocks to Templates"}}},{"node":{"fields":{"slug":"/how-to/add-external-scripts-from-a-block","title":"Add External Scripts from a Block"}}},{"node":{"fields":{"slug":"/how-to/add-page-to-theme","title":"How to Add a Page to a Theme"}}},{"node":{"fields":{"slug":"/how-to/add-page-with-uri-parameters","title":"How to Add a Page That Depends on URI Parameters"}}},{"node":{"fields":{"slug":"/how-to/data-third-party-services","title":"Data ThirdParty Services"}}},{"node":{"fields":{"slug":"/how-to/communicate-between-blocks","title":"Communicate Between Blocks"}}},{"node":{"fields":{"slug":"/how-to/env-setup","title":"Environment Setup"}}},{"node":{"fields":{"slug":"/how-to/data-volusion-api","title":"Data Volusion API"}}},{"node":{"fields":{"slug":"/how-to/get-approved-to-develop-blocks","title":"How to Get Approved to Develop Blocks"}}},{"node":{"fields":{"slug":"/how-to/interact-with-the-cart","title":"How to Interact with the Cart"}}},{"node":{"fields":{"slug":"/how-to/fetch-data-fast","title":"Fetch Data Fast"}}},{"node":{"fields":{"slug":"/how-to/proptypes","title":"Element Proptypes"}}},{"node":{"fields":{"slug":"/how-to/preview-block-changes","title":"Preview Block Changes"}}},{"node":{"fields":{"slug":"/how-to/release-a-new-major-block-version","title":"Release A New Major Block Version"}}},{"node":{"fields":{"slug":"/how-to/read-page-uri-parameters-in-blocks","title":"Read Page URI Parameters In Blocks"}}},{"node":{"fields":{"slug":"/how-to/release-a-minor-block-change","title":"Release A Minor Block Change"}}},{"node":{"fields":{"slug":"/how-to/reuse-a-block-across-pages","title":"Reuse A Block Across Pages"}}},{"node":{"fields":{"slug":"/how-to/rollback-a-block-change","title":"Rollback A Block Change"}}},{"node":{"fields":{"slug":"/how-to/style-a-block-with-aphrodite","title":"Style A Block With Aphrodite"}}},{"node":{"fields":{"slug":"/how-to/set-seo-data-from-a-block","title":"Set SEO Data From A Block"}}},{"node":{"fields":{"slug":"/how-to/track-block-versions","title":"Track Block Versions"}}},{"node":{"fields":{"slug":"/explanations/adding-a-blog","title":"Adding a Blog"}}},{"node":{"fields":{"slug":"/explanations/all-the-tech-you-need","title":"All The Tech You Need"}}},{"node":{"fields":{"slug":"/explanations/block-versions","title":"Block Versions"}}},{"node":{"fields":{"slug":"/explanations/e-commerce-pages","title":"E-commerce Theme Pages"}}},{"node":{"fields":{"slug":"/explanations/element-concepts","title":"Element Concepts"}}},{"node":{"fields":{"slug":"/explanations/keeping-your-site-fast","title":"Keeping Your Site Fast"}}},{"node":{"fields":{"slug":"/explanations/what-is-element","title":"What Is Element?"}}},{"node":{"fields":{"slug":"/references/sdk","title":"SDK"}}},{"node":{"fields":{"slug":"/tutorials/proptypes","title":"Proptypes"}}},{"node":{"fields":{"slug":"/tutorials/site-designer","title":"Site Designer"}}},{"node":{"fields":{"slug":"/tutorials/building-an-element-page","title":"Building An Element Page"}}},{"node":{"fields":{"slug":"/tutorials/product-landing-page","title":"Product Landing Page"}}}]}},"pageContext":{"id":"39da7718-2b20-5b0e-93d4-656400fbf1fb"}}}